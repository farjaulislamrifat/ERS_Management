<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - ERS_Management</title>
    <script type="importmap"></script>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/ERS_Management.styles.css" asp-append-version="true" />
    <link href="~/Content/kendo/2025.3.1010/kendo.common.min.css" rel="stylesheet" />
    <link href="~/Content/kendo/2025.3.1010/kendo.default-v2.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/exceljs@4.4.0/dist/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <!-- Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css" rel="stylesheet" />


    @RenderSection("Styles", required: false)
</head>
<body>
    <header>
        <nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
            <div class="container-fluid">
                <a class="navbar-brand" asp-area="" asp-controller="Home" asp-action="Index">ERS_Management</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse" aria-controls="navbarSupportedContent"
                        aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            
                @if (User.Identity.IsAuthenticated)
                {
                  
                    <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                        <ul class="navbar-nav flex-grow-1">
                        
                            <li class="nav-item">
                                <a class="nav-link" asp-controller="Entries" asp-action="Home">Entries</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" asp-controller="FaultEntries" asp-action="Home">Reports</a>
                            </li>



                        </ul>
                    </div>

                    <div style="position: relative; display: inline-block;">


                        <div onclick="this.nextElementSibling.style.display = (this.nextElementSibling.style.display === 'block') ? 'none' : 'block';"
                             style="
                   display: inline-flex;
                   align-items: center;
                   gap: 10px;
                   background: white;
                   padding: 8px 12px;
                   border-radius: 8px;
                   box-shadow: 0 2px 6px rgba(0,0,0,0.1);
                   cursor: pointer;
                   user-select: none;
                   transition: background 0.2s;
                 "
                             onmouseover="this.style.background='#f5f5f5';"
                             onmouseout="this.style.background='white';">


                            <div style="width: 36px; height: 36px; border-radius: 50%; overflow: hidden; flex-shrink: 0;">
                                <img src="~/images/icons8-user-96.png" alt="User" style="width:100%; height:100%; object-fit:cover;" />
                            </div>


                            <span style="font-weight: 600; font-size: 14px; color: #1a1a1a;">@User.Identity.Name</span>


                            <span style="font-size: 12px; color: #666; margin-left: 4px;">▼</span>
                        </div>


                        <div style="
              position: absolute;
              top: 100%;
              left: 0;
              right: 0;
              background: white;
              border-radius: 8px;
              margin-top: 4px;
              box-shadow: 0 4px 12px rgba(0,0,0,0.15);
              overflow: hidden;
              z-index: 1000;
              display: none;
              min-width: 180px;
            ">
                            <a href="#profile" style="display: block; padding: 10px 14px; text-decoration: none; color: #333; font-size: 14px; transition: background 0.2s;"
                               onmouseover="this.style.background='#f0f0f0';" onmouseout="this.style.background='transparent';">
                                👤 My Profile
                            </a>
                            <hr style="margin: 4px 0; border: none; border-top: 1px solid #eee;" />
                            <a asp-controller="Account" asp-action="Logout" style="display: block; padding: 10px 14px; text-decoration: none; color: #d32f2f; font-size: 14px; font-weight: 500; transition: background 0.2s;"
                               onmouseover="this.style.background='#ffebee';" onmouseout="this.style.background='transparent';">
                                🚪 Log Out
                            </a>
                        </div>
                    </div>

                    <!-- Close menu when clicking outside -->
                    <script>
                        document.addEventListener('click', function(e) {
                          const menus = document.querySelectorAll('[style*="position: absolute"][style*="display: block"]');
                          menus.forEach(menu => {
                            const trigger = menu.previousElementSibling;
                            if (!trigger.contains(e.target) && !menu.contains(e.target)) {
                              menu.style.display = 'none';
                            }
                          });
                        });
                    </script>
                }
            </div>
        </nav>
    </header>
    <div class="container-fluid">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

   
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/Scripts/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <!-- Kendo UI Core JS -->
    <script src="~/Scripts/kendo/2025.3.1010/kendo.all.min.js"></script>
    <script src="~/Scripts/kendo/2025.3.1010/kendo.aspnetmvc.min.js"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>
